{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useAuth}from'../contexts/AuthContext';import Navbar from'../components/Navbar';import{registerUser,fetchOrganizations}from'../services/api';import'./css/RegisterStaffPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const RegisterStaffPage=()=>{const[firstName,setFirstName]=useState('');const[lastName,setLastName]=useState('');const[email,setEmail]=useState('');const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[roleId,setRoleId]=useState(2);// Default till Practitioner\nconst[organizationId,setOrganizationId]=useState(null);const[organizations,setOrganizations]=useState([]);const[success,setSuccess]=useState(null);const[error,setError]=useState(null);const{user}=useAuth();// Hämta organizationer vid sidladdning\nuseEffect(()=>{const loadOrganizations=async()=>{try{const data=await fetchOrganizations();setOrganizations(data);}catch(err){console.error('Error fetching organizations:',err);}};loadOrganizations();},[]);// Fördefinierade roller\nconst roles=[{id:2,name:'Practitioner'},{id:3,name:'Other'}];const handleSubmit=async e=>{e.preventDefault();setError(null);setSuccess(null);try{const userData={firstName,lastName,email,username,password,roleId,organizationId};const response=await registerUser(userData);setSuccess('Användaren skapades framgångsrikt!');console.log('Register response:',response);}catch(err){setError('Ett fel uppstod vid registreringen.');console.error(err);}};// Förhindra åtkomst om användaren inte är admin\nif(!user||user.role!=='ADMIN'){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\xC5tkomst nekad\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Du har inte beh\\xF6righet att se den h\\xE4r sidan.\"})]});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"h2\",{children:\"Registrera Personal\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"register-staff-form\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"F\\xF6rnamn:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:firstName,onChange:e=>setFirstName(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Efternamn:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:lastName,onChange:e=>setLastName(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,onChange:e=>setEmail(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Anv\\xE4ndarnamn:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:username,onChange:e=>setUsername(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"L\\xF6senord:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Roll:\"}),/*#__PURE__*/_jsx(\"select\",{value:roleId,onChange:e=>setRoleId(Number(e.target.value)),children:roles.map(role=>/*#__PURE__*/_jsx(\"option\",{value:role.id,children:role.name},role.id))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Organisation:\"}),/*#__PURE__*/_jsxs(\"select\",{value:organizationId||'',onChange:e=>setOrganizationId(Number(e.target.value)),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Ingen organisation\"}),organizations.map(org=>/*#__PURE__*/_jsx(\"option\",{value:org.id,children:org.name},org.id))]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Registrera\"}),success&&/*#__PURE__*/_jsx(\"p\",{className:\"success-message\",children:success}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error})]})]});};export default RegisterStaffPage;","map":{"version":3,"names":["React","useState","useEffect","useAuth","Navbar","registerUser","fetchOrganizations","jsx","_jsx","jsxs","_jsxs","RegisterStaffPage","firstName","setFirstName","lastName","setLastName","email","setEmail","username","setUsername","password","setPassword","roleId","setRoleId","organizationId","setOrganizationId","organizations","setOrganizations","success","setSuccess","error","setError","user","loadOrganizations","data","err","console","roles","id","name","handleSubmit","e","preventDefault","userData","response","log","role","children","onSubmit","className","type","value","onChange","target","required","Number","map","org"],"sources":["/Users/sonos/Developer/CM1007LABB2/frontend/src/pages/RegisterStaffPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport Navbar from '../components/Navbar';\nimport { registerUser, fetchOrganizations } from '../services/api';\nimport './css/RegisterStaffPage.css';\nimport { CreateUserRequest } from '../types/requests/CreateUserRequest';\nimport { OrganizationResponse } from '../types/responses';\n\nconst RegisterStaffPage: React.FC = () => {\n  const [firstName, setFirstName] = useState<string>('');\n  const [lastName, setLastName] = useState<string>('');\n  const [email, setEmail] = useState<string>('');\n  const [username, setUsername] = useState<string>('');\n  const [password, setPassword] = useState<string>('');\n  const [roleId, setRoleId] = useState<number>(2); // Default till Practitioner\n  const [organizationId, setOrganizationId] = useState<number | null>(null);\n  const [organizations, setOrganizations] = useState<OrganizationResponse[]>([]);\n  const [success, setSuccess] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  const { user } = useAuth();\n\n  // Hämta organizationer vid sidladdning\n  useEffect(() => {\n    const loadOrganizations = async () => {\n      try {\n        const data = await fetchOrganizations();\n        setOrganizations(data);\n      } catch (err) {\n        console.error('Error fetching organizations:', err);\n      }\n    };\n\n    loadOrganizations();\n  }, []);\n\n  // Fördefinierade roller\n  const roles = [\n    { id: 2, name: 'Practitioner' },\n    { id: 3, name: 'Other' },\n  ];\n\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setError(null);\n    setSuccess(null);\n\n    try {\n      const userData: CreateUserRequest = {\n        firstName,\n        lastName,\n        email,\n        username,\n        password,\n        roleId,\n        organizationId,\n      };\n\n      const response = await registerUser(userData);\n      setSuccess('Användaren skapades framgångsrikt!');\n      console.log('Register response:', response);\n    } catch (err) {\n      setError('Ett fel uppstod vid registreringen.');\n      console.error(err);\n    }\n  };\n\n  // Förhindra åtkomst om användaren inte är admin\n  if (!user || user.role !== 'ADMIN') {\n    return (\n      <div>\n        <Navbar />\n        <h2>Åtkomst nekad</h2>\n        <p>Du har inte behörighet att se den här sidan.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <Navbar />\n      <h2>Registrera Personal</h2>\n      <form onSubmit={handleSubmit} className=\"register-staff-form\">\n        <div>\n          <label>Förnamn:</label>\n          <input\n            type=\"text\"\n            value={firstName}\n            onChange={(e) => setFirstName(e.target.value)}\n            required\n          />\n        </div>\n        <div>\n          <label>Efternamn:</label>\n          <input\n            type=\"text\"\n            value={lastName}\n            onChange={(e) => setLastName(e.target.value)}\n            required\n          />\n        </div>\n        <div>\n          <label>Email:</label>\n          <input\n            type=\"email\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n            required\n          />\n        </div>\n        <div>\n          <label>Användarnamn:</label>\n          <input\n            type=\"text\"\n            value={username}\n            onChange={(e) => setUsername(e.target.value)}\n            required\n          />\n        </div>\n        <div>\n          <label>Lösenord:</label>\n          <input\n            type=\"password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            required\n          />\n        </div>\n        <div>\n          <label>Roll:</label>\n          <select value={roleId} onChange={(e) => setRoleId(Number(e.target.value))}>\n            {roles.map((role) => (\n              <option key={role.id} value={role.id}>\n                {role.name}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div>\n          <label>Organisation:</label>\n          <select\n            value={organizationId || ''}\n            onChange={(e) => setOrganizationId(Number(e.target.value))}\n          >\n            <option value=\"\">Ingen organisation</option>\n            {organizations.map((org) => (\n              <option key={org.id} value={org.id}>\n                {org.name}\n              </option>\n            ))}\n          </select>\n        </div>\n        <button type=\"submit\">Registrera</button>\n        {success && <p className=\"success-message\">{success}</p>}\n        {error && <p className=\"error-message\">{error}</p>}\n      </form>\n    </div>\n  );\n};\n\nexport default RegisterStaffPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}